<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Many-body dispersion library">
    
    <meta name="author" content="" >
    <link rel="icon" href="../favicon.png">

    <title>mbd_calc_t &ndash; Libmbd </title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    
    <link href="../css/user.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">Libmbd </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>mbd_calc_t
    <small>Derived Type</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title="<p>12.9% of total for derived types.</p>Including implementation: 189 statements, 31.5% of total for derived types.">26 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/mbd.F90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/mbd.f90.html'>mbd.F90</a></li>
    
     <li><a href='../module/mbd.html'>mbd</a></li>
    
  
     <li class="active">mbd_calc_t</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 



















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#boundprocs-0">Type-Bound Procedures</a></h3></div>
  <div id="boundprocs-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-init">init</a>
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-destroy">destroy</a>
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-update_coords">update_coords</a>
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-update_lattice_vectors">update_lattice_vectors</a>
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-update_vdw_params_custom">update_vdw_params_custom</a>
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-update_vdw_params_from_ratios">update_vdw_params_from_ratios</a>
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-update_vdw_params_nl">update_vdw_params_nl</a>
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-evaluate_vdw_method">evaluate_vdw_method</a>
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-get_gradients">get_gradients</a>
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-get_lattice_derivs">get_lattice_derivs</a>
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-get_lattice_stress">get_lattice_stress</a>
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-get_spectrum_modes">get_spectrum_modes</a>
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-get_rpa_orders">get_rpa_orders</a>
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-get_exception">get_exception</a>
      
    </div>
  </div>
</div>





</div>

    </div>
    
    <div class="col-md-9" id='text'>
      <h2>type, public :: mbd_calc_t</h2>
    <p>Represents an MBD calculation.</p>
    
    
    
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 



















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#boundprocs-1">Type-Bound Procedures</a></h3></div>
  <div id="boundprocs-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-init">init</a>
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-destroy">destroy</a>
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-update_coords">update_coords</a>
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-update_lattice_vectors">update_lattice_vectors</a>
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-update_vdw_params_custom">update_vdw_params_custom</a>
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-update_vdw_params_from_ratios">update_vdw_params_from_ratios</a>
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-update_vdw_params_nl">update_vdw_params_nl</a>
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-evaluate_vdw_method">evaluate_vdw_method</a>
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-get_gradients">get_gradients</a>
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-get_lattice_derivs">get_lattice_derivs</a>
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-get_lattice_stress">get_lattice_stress</a>
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-get_spectrum_modes">get_spectrum_modes</a>
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-get_rpa_orders">get_rpa_orders</a>
      
      <a class="list-group-item" href="../type/mbd_calc_t.html#boundprocedure-get_exception">get_exception</a>
      
    </div>
  </div>
</div>





    </section>
    <br class="visible-xs visible-sm hidden-md">

    
    
    
    
    
    
     
    <section>
    <h2>Type-Bound Procedures</h2>
    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-init"></span><h3>procedure, public :: <strong>init</strong>  => mbd_calc_init 
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private subroutine mbd_calc_init(this, input)
    
    
   
</h3>
    



<p>Initialize an MBD calculation from an MBD input.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/mbd_calc_t.html'>mbd_calc_t</a>),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>type(<a href='../type/mbd_input_t.html'>mbd_input_t</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>input</strong></td><td><p>MBD input.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-destroy"></span><h3>procedure, public :: <strong>destroy</strong>  => mbd_calc_destroy 
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private subroutine mbd_calc_destroy(this)
    
    
   
</h3>
    



<p>Finalize an MBD calculation.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/mbd_calc_t.html'>mbd_calc_t</a>),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-update_coords"></span><h3>procedure, public :: <strong>update_coords</strong>  => mbd_calc_update_coords 
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private subroutine mbd_calc_update_coords(this, coords)
    
    
   
</h3>
    



<p>Update atomic coordinates.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/mbd_calc_t.html'>mbd_calc_t</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>coords</strong>(:,:)</td><td><p>(<script type="math/tex">3\times N</script>, a.u.) New atomic coordinates.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-update_lattice_vectors"></span><h3>procedure, public :: <strong>update_lattice_vectors</strong>  => mbd_calc_update_lattice_vectors 
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private subroutine mbd_calc_update_lattice_vectors(this, latt_vecs)
    
    
   
</h3>
    



<p>Update unit-cell lattice vectors.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/mbd_calc_t.html'>mbd_calc_t</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>latt_vecs</strong>(:,:)</td><td><p>(<script type="math/tex">3\times 3</script>, a.u.) New lattice vectors in columns.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-update_vdw_params_custom"></span><h3>procedure, public :: <strong>update_vdw_params_custom</strong>  => mbd_calc_update_vdw_params_custom 
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private subroutine mbd_calc_update_vdw_params_custom(this, alpha_0, C6, r_vdw)
    
    
   
</h3>
    



<p>Update vdW parameters in a custom way.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/mbd_calc_t.html'>mbd_calc_t</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>alpha_0</strong>(:)</td><td><p>(a.u.) New atomic static polarizabilities.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>C6</strong>(:)</td><td><p>(a.u.) New atomic <script type="math/tex">C_6</script> coefficients.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>r_vdw</strong>(:)</td><td><p>(a.u.) New atomic vdW radii.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-update_vdw_params_from_ratios"></span><h3>procedure, public :: <strong>update_vdw_params_from_ratios</strong>  => mbd_calc_update_vdw_params_from_ratios 
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private subroutine mbd_calc_update_vdw_params_from_ratios(this, ratios)
    
    
   
</h3>
    



<p>Update vdW parameters based on scaling of free-atom values.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/mbd_calc_t.html'>mbd_calc_t</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ratios</strong>(:)</td><td><p>Ratios of atomic volumes in the system and in vacuum.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-update_vdw_params_nl"></span><h3>procedure, public :: <strong>update_vdw_params_nl</strong>  => mbd_calc_update_vdw_params_nl 
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private subroutine mbd_calc_update_vdw_params_nl(this, alpha_0_ratios, C6_ratios)
    
    
   
</h3>
    



<p>Update vdW parameters for the MBD-NL method.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/mbd_calc_t.html'>mbd_calc_t</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>alpha_0_ratios</strong>(:)</td><td><p>Ratios of free-atom exact static polarizabilities and those from the
 VV functional.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>C6_ratios</strong>(:)</td><td><p>Ratios of free-atom exact <script type="math/tex">C_6</script> coefficients and those from the VV
 functional.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-evaluate_vdw_method"></span><h3>procedure, public :: <strong>evaluate_vdw_method</strong>  => mbd_calc_evaluate_vdw_method 
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private subroutine mbd_calc_evaluate_vdw_method(this, energy)
    
    
   
</h3>
    



<p>Evaluate a given vdW method for a given system and vdW parameters,
 retrieve energy.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/mbd_calc_t.html'>mbd_calc_t</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dp),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>energy</strong></td><td><p>(a.u.) VdW energy.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-get_gradients"></span><h3>procedure, public :: <strong>get_gradients</strong>  => mbd_calc_get_gradients 
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private subroutine mbd_calc_get_gradients(this, gradients)
    
    
   
</h3>
    



<p>Retrieve nuclear energy gradients if they were requested in the MBD
 input.</p>
<p>The gradients are calculated together with the energy, so a call to this
 method must be preceeded by a call to
 <a href="../type/mbd_calc_t.html#boundprocedure-evaluate_vdw_method">evaluate_vdw_method</a>.  For the same reason, the
 gradients must be requested prior to this called via
 <a href="../type/mbd_input_t.html#variable-calculate_forces">calculate_forces</a>.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/mbd_calc_t.html'>mbd_calc_t</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dp),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>gradients</strong>(:,:)</td><td><p>(<script type="math/tex">3\times N</script>, a.u.) Energy gradients, <script type="math/tex">\mathrm dE/\mathrm d\mathbf
 R_i</script>, index <script type="math/tex">i</script> runs over columns.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-get_lattice_derivs"></span><h3>procedure, public :: <strong>get_lattice_derivs</strong>  => mbd_calc_get_lattice_derivs 
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private subroutine mbd_calc_get_lattice_derivs(this, latt_derivs)
    
    
   
</h3>
    



<p>Provide lattice-vector energy gradients if they were requested in the MBD
 input.</p>
<p>The gradients are actually calculated together with the energy, so a call
 to this method must be preceeded by a call to
 <a href="../type/mbd_calc_t.html#boundprocedure-evaluate_vdw_method">evaluate_vdw_method</a>.  For the same reason, the
 gradients must be requested prior to this called via
 <a href="../type/mbd_input_t.html#variable-calculate_forces">calculate_forces</a>.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/mbd_calc_t.html'>mbd_calc_t</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dp),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>latt_derivs</strong>(:,:)</td><td><p>(<script type="math/tex">3\times 3</script>, a.u.) Energy gradients, <script type="math/tex">\mathrm dE/\mathrm d\mathbf
 a_i</script>, index <script type="math/tex">i</script> runs over columns.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-get_lattice_stress"></span><h3>procedure, public :: <strong>get_lattice_stress</strong>  => mbd_calc_get_lattice_stress 
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private subroutine mbd_calc_get_lattice_stress(this, stress)
    
    
   
</h3>
    



<p>Provide stress tensor of the lattice.</p>
<p>This is a utility function wrapping <a href="../type/mbd_calc_t.html#boundprocedure-get_lattice_derivs">get_lattice_derivs</a>.
 The lattice vector gradients are coverted to the stress tensor.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/mbd_calc_t.html'>mbd_calc_t</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dp),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>stress</strong>(:,:)</td><td><p>(<script type="math/tex">3\times 3</script>, a.u.) Stress tensor.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-get_spectrum_modes"></span><h3>procedure, public :: <strong>get_spectrum_modes</strong>  => mbd_calc_get_spectrum_modes 
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private subroutine mbd_calc_get_spectrum_modes(this, spectrum, modes)
    
    
   
</h3>
    



<p>Provide MBD spectrum if it was requested in the MBD input.</p>
<p>The spectrum is actually calculated together with the energy, so a call
 to this method must be preceeded by a call to
 <a href="../type/mbd_calc_t.html#boundprocedure-evaluate_vdw_method">evaluate_vdw_method</a>.  For the same reason, the
 spectrum must be requested prior to this call via
 <a href="../type/mbd_input_t.html#variable-calculate_spectrum">calculate_spectrum</a>.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/mbd_calc_t.html'>mbd_calc_t</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dp),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>spectrum</strong>(:)</td><td><p>(<script type="math/tex">3N</script>, a.u.) Energies (frequencies) of coupled MBD modues,
 <script type="math/tex">\omega_i</script>.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dp),</td>
  <td>intent(out),</td>
  <td>optional</td>
  
  <td>allocatable</td><td>::</td>
  <td><strong>modes</strong>(:,:)</td><td><p>(<script type="math/tex">3N\times 3N</script>) Coupled-mode wave functions (MBD eigenstates),
 <script type="math/tex">\psi_j</script>, in the basis of uncoupled states,
 <script type="math/tex">C_{ij}=\langle\phi_i|\psi_j\rangle</script>, index <script type="math/tex">j</script> runs over
 columns.</p>
<p>To save memory, the argument must be allocatable, and the method
 transfers allocation from the internal state to the argument. For
 this reason, the method can be called only once wih this optional
 argument per calculation.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-get_rpa_orders"></span><h3>procedure, public :: <strong>get_rpa_orders</strong>  => mbd_calc_get_rpa_orders 
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private subroutine mbd_calc_get_rpa_orders(this, rpa_orders)
    
    
   
</h3>
    



<p>Provide RPA orders if they were requested in the MBD input.</p>
<p>The orders are actually calculated together with the energy, so a call
 to this method must be preceeded by a call to
 <a href="../type/mbd_calc_t.html#boundprocedure-evaluate_vdw_method">evaluate_vdw_method</a>. For the same reason, the
 spectrum must be requested prior to this call via
 <a href="../type/mbd_input_t.html#variable-do_rpa">do_rpa</a> and <a href="../type/mbd_input_t.html#variable-rpa_orders">rpa_orders</a>.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/mbd_calc_t.html'>mbd_calc_t</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dp),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>allocatable</td><td>::</td>
  <td><strong>rpa_orders</strong>(:)</td><td><p>(a.u.) MBD energy decomposed to RPA orders.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-get_exception"></span><h3>procedure, public :: <strong>get_exception</strong>  => mbd_calc_get_exception 
    
  </h3></div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          
    
    <h3>
private subroutine mbd_calc_get_exception(this, code, origin, msg)
    
    
   
</h3>
    



<p>Retrieve an exception in the MBD calculation if it occured.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/mbd_calc_t.html'>mbd_calc_t</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>this</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>code</strong></td><td><p>Exception code, values defined in <a href="../module/mbd_constants.html">mbd_constants</a>.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>origin</strong></td><td><p>Exception origin.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>msg</strong></td><td><p>Exception message.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
    </section>
    
    
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" /></a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> Libmbd was developed by </p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>